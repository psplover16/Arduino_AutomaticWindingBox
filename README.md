# 自動上鍊盒（Watch Winder）

這個專案是一個使用 Arduino 控制的簡易自動上鍊盒程式（`arduino-watch-winder.ino`），目標是一日內提供約 1086 圈的上鍊動作，並可透過實體開關在「正常模式」與「高速模式」之間切換。

## 硬體組成（簡單）

- Arduino（任何支援類似腳位的板子，例如 Uno、Nano）
- SPDT 開關（單刀雙擲）
- 直流馬達（或步進馬達搭配驅動，視實際馬達需求）
- 驅動電路或 MOSFET（建議使用適合馬達電流的驅動模組）
- 電源（依馬達需求，請確保 Arduino 與馬達共地）

## 腳位接線（對應程式）

- A4：開關輸入（使用內部上拉電阻）
  - 接法：一端接到開關輸出，開關的另一端接地或 Vcc，視你的實體開關接法而定（程式以開關關閉為 HIGH，開啟為 LOW）。
- A5：開關另一端（在你的描述中開關接到 A5 與 A4；程式本身只讀取 A4，確保實際硬體正確接線以符合程式邏輯）
- A0：馬達控制腳位 1
- A1：馬達控制腳位 2

注意：A0、A1 在程式中會被數位輸出 HIGH/LOW 來改變馬達極性，達到順時針或逆時針旋轉。實際上若使用直流馬達，請使用 H-bridge 或電機驅動板來切換方向，不要直接用 Arduino 腳位驅動馬達。

## 程式流程與模式

- 正常模式（開關關閉，`A4 == HIGH`）：
  1. 順時針旋轉 3 圈（每圈預設 6 秒）。
  2. 停止並休息 220 秒。
  3. 逆時針旋轉 3 圈。
  4. 停止並休息 220 秒。
  5. 重複以上循環（每個循環約 476 秒），大約一天可達成 1086 圈。

- 高速模式（開關打開，`A4 == LOW`）：
  - 不休息，連續交替執行逆時針 3 圈與順時針 3 圈，直到切換回正常模式。

- 程式會在每個轉動或休息階段持續檢查 `A4` 的狀態，一旦偵測到模式切換會立刻停止馬達並切換流程。

## 重要程式參數（可調）

- `SECONDS_PER_ROTATION`（預設 6）：每圈秒數，依馬達與齒輪比調整。
- `CLOCKWISE_ROTATIONS`、`COUNTERCLOCKWISE_ROTATIONS`（預設 3）：每次轉動的圈數。
- `REST_TIME`（預設 220000 毫秒）：每次休息時間，單位為毫秒。

修改這些常數會影響每日總圈數與操作節奏，請依實際機芯與需求調整。

## 使用注意事項

- 馬達電源與 Arduino 地線必須共地。
- 千萬不要直接用 Arduino 腳位直接供應馬達電流，會損壞 MCU。請使用合適的驅動器（例如 L298N、TB6612、MOSFET 與 H-bridge 模組等）。
- 建議在實際上機前先用較低電壓或軟體模擬測試，確保方向與秒數設定正確。
- 若使用機械連動（齒輪、皮帶），確認扭力與轉速足以驅動表芯，避免過度負載。

## 常見故障與排查

- 馬達不轉：
  - 檢查驅動模組與馬達電源是否有電。
  - 檢查 Arduino 與驅動器之間的控制線（A0/A1）是否有適當訊號。
  - 確認共地連接。

- 方向相反：
  - 將 A0/A1 的邏輯顛倒（或交換馬達輸出線）來修正。

- 開關行為與預期不符：
  - 使用萬用表測試開關接腳，在不同位置確認 A4 的數位讀值（HIGH/LOW）。
  - 程式使用內部上拉（INPUT_PULLUP），預設為 HIGH，切換到 LOW 表示開關閉合接地。

## 程式（參考）

主程式檔案：`arduino-watch-winder.ino`（請參考工作區內現有檔案）

程式已實作以下函式：
- `clockwiseRotations(rotations)`：順時針轉動指定圈數。
- `counterclockwiseRotations(rotations)`：逆時針轉動指定圈數。
- `waitWithCheck(duration)`：休息期間每秒顯示剩餘時間，並檢查開關是否切換。
- `stopMotor()`：停止馬達（將 A0/A1 設為 LOW）。

## 建議後續改良

- 加入 NTP 或實時計時器來更精準地排程運作時間。
- 使用 EEPROM 或外部配置檔讓使用者能在不重新編譯的情況下調整參數。
- 加入 OLED 或 LCD 顯示目前模式、剩餘時間與今日總圈數。
- 加入限流偵測或電流偵測，避免馬達過載造成損壞。

---

若你要我把 README 改成英文、加入接線圖（圖片）或調整任何文字，告訴我想要的內容，我會繼續修改。